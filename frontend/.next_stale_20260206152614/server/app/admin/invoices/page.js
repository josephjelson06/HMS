(()=>{var e={};e.id=4317,e.ids=[4317],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5347:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>r.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>d,routeModule:()=>p,tree:()=>c}),s(2400),s(596),s(4752),s(5866);var n=s(3191),a=s(8716),i=s(7922),r=s.n(i),l=s(5231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(t,o);let c=["",{children:["admin",{children:["invoices",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,2400)),"C:\\Users\\josep\\Documents\\AarkayTechnoConsultants\\HMS\\frontend\\app\\admin\\invoices\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,596)),"C:\\Users\\josep\\Documents\\AarkayTechnoConsultants\\HMS\\frontend\\app\\admin\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,4752)),"C:\\Users\\josep\\Documents\\AarkayTechnoConsultants\\HMS\\frontend\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],d=["C:\\Users\\josep\\Documents\\AarkayTechnoConsultants\\HMS\\frontend\\app\\admin\\invoices\\page.tsx"],u="/admin/invoices/page",m={require:s,loadChunk:()=>Promise.resolve()},p=new n.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/admin/invoices/page",pathname:"/admin/invoices",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},6475:(e,t,s)=>{Promise.resolve().then(s.bind(s,5786))},558:(e,t,s)=>{Promise.resolve().then(s.bind(s,2802))},5786:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>P});var n=s(326),a=s(7577),i=s(9557),r=s(4863),l=s(6126),o=s(3556),c=s(7574),d=s(1346),u=s(6062),m=s(4381),p=s(5430),x=s(7759),h=s(7118),v=s(5979),j=s(4909),g=s(5495),_=s(1852),y=s(9684);let b={list:(e=1,t=20)=>(0,y.S)(`/admin/invoices?page=${e}&limit=${t}`),create:e=>(0,y.S)("/admin/invoices",{method:"POST",body:JSON.stringify(e)}),update:(e,t)=>(0,y.S)(`/admin/invoices/${e}`,{method:"PUT",body:JSON.stringify(t)}),remove:e=>(0,y.S)(`/admin/invoices/${e}`,{method:"DELETE"})};var f=s(6649);let N={tenant_id:"",subscription_id:"",invoice_number:"",status:"issued",amount_cents:0,currency:"USD",issued_at:"",due_at:"",paid_at:"",notes:""},S=e=>{if(!e)return;let t=new Date(e);return isNaN(t.getTime())?void 0:t.toISOString()},C=e=>e?e.slice(0,10):"";function P(){let[e,t]=(0,a.useState)([]),[s,y]=(0,a.useState)([]),[P,w]=(0,a.useState)([]),[k,$]=(0,a.useState)(!0),[D,q]=(0,a.useState)(N),[T,A]=(0,a.useState)(null),[E,Z]=(0,a.useState)(null),M=(0,a.useCallback)(async()=>{$(!0),Z(null);try{let[e,s,n]=await Promise.all([b.list(1,50),_.B.list(1,100),f.J.list(1,100)]);t(e.items),y(s.items),w(n.items)}catch(e){Z(e instanceof Error?e.message:"Failed to load invoices")}finally{$(!1)}},[]),U=(e,t)=>{q(s=>({...s,[e]:t}))},I=()=>{q(N),A(null)},O=(0,a.useMemo)(()=>({tenant_id:D.tenant_id,subscription_id:D.subscription_id,invoice_number:D.invoice_number||void 0,status:D.status,amount_cents:Number(D.amount_cents),currency:D.currency||void 0,issued_at:S(D.issued_at),due_at:S(D.due_at),paid_at:S(D.paid_at),notes:D.notes||void 0}),[D]),H=(0,a.useMemo)(()=>({tenant_id:D.tenant_id||void 0,subscription_id:D.subscription_id||void 0,invoice_number:D.invoice_number||void 0,status:D.status||void 0,amount_cents:Number(D.amount_cents),currency:D.currency||void 0,issued_at:S(D.issued_at),due_at:S(D.due_at),paid_at:S(D.paid_at),notes:D.notes||void 0}),[D]),J=async e=>{e.preventDefault(),Z(null);try{T?await b.update(T.id,H):await b.create(O),I(),await M()}catch(e){Z(e instanceof Error?e.message:"Failed to save invoice")}},z=e=>{A(e),q({tenant_id:e.tenant_id,subscription_id:e.subscription_id,invoice_number:e.invoice_number,status:e.status,amount_cents:e.amount_cents,currency:e.currency,issued_at:C(e.issued_at),due_at:C(e.due_at),paid_at:C(e.paid_at),notes:e.notes??""})},F=async e=>{if(confirm(`Delete invoice ${e.invoice_number}? This cannot be undone.`))try{await b.remove(e.id),await M()}catch(e){Z(e instanceof Error?e.message:"Failed to delete invoice")}};return n.jsx(i.n,{permission:"admin:invoices:read",fallback:(0,n.jsxs)(p.W,{className:"p-6",children:[n.jsx("h2",{className:"text-2xl",children:"Access denied"}),n.jsx("p",{className:"mt-2 text-sm text-[color:var(--color-text-muted)]",children:"You do not have permission to view invoices."})]}),children:(0,n.jsxs)("div",{className:"space-y-6",children:[n.jsx(r.m,{title:"Invoices",description:"Issue invoices for hotel subscriptions and track billing status.",count:e.length,countLabel:"Invoices"}),n.jsx(i.n,{permission:T?"admin:invoices:update":"admin:invoices:create",children:n.jsx(l.y,{title:T?"Edit Invoice":"Create Invoice",children:(0,n.jsxs)("form",{className:"grid gap-4 md:grid-cols-2",onSubmit:J,children:[n.jsx(h.g,{label:"Hotel",required:!0,children:(0,n.jsxs)(v.l,{value:D.tenant_id,onChange:e=>U("tenant_id",e.target.value),required:!0,children:[n.jsx("option",{value:"",children:"Select hotel"}),s.map(e=>n.jsx("option",{value:e.id,children:e.name},e.id))]})}),n.jsx(h.g,{label:"Subscription",required:!0,children:(0,n.jsxs)(v.l,{value:D.subscription_id,onChange:e=>U("subscription_id",e.target.value),required:!0,children:[n.jsx("option",{value:"",children:"Select subscription"}),P.map(e=>(0,n.jsxs)("option",{value:e.id,children:[e.tenant_name??e.tenant_id," -"," ",e.plan_name??e.plan_code??e.plan_id]},e.id))]})}),n.jsx(h.g,{label:"Invoice Number",children:n.jsx(g.o,{value:D.invoice_number,onChange:e=>U("invoice_number",e.target.value),placeholder:"INV-0001"})}),n.jsx(h.g,{label:"Status",children:n.jsx(g.o,{value:D.status,onChange:e=>U("status",e.target.value),placeholder:"issued"})}),n.jsx(h.g,{label:"Amount (cents)",required:!0,children:n.jsx(g.o,{type:"number",min:0,value:D.amount_cents,onChange:e=>U("amount_cents",Number(e.target.value)),placeholder:"9900",required:!0})}),n.jsx(h.g,{label:"Currency",children:n.jsx(g.o,{value:D.currency,onChange:e=>U("currency",e.target.value),placeholder:"USD"})}),n.jsx(h.g,{label:"Issued At",children:n.jsx(g.o,{type:"date",value:D.issued_at,onChange:e=>U("issued_at",e.target.value)})}),n.jsx(h.g,{label:"Due At",children:n.jsx(g.o,{type:"date",value:D.due_at,onChange:e=>U("due_at",e.target.value)})}),n.jsx(h.g,{label:"Paid At",children:n.jsx(g.o,{type:"date",value:D.paid_at,onChange:e=>U("paid_at",e.target.value)})}),n.jsx(h.g,{label:"Notes",className:"md:col-span-2",children:n.jsx(j.F,{value:D.notes,onChange:e=>U("notes",e.target.value),rows:3,placeholder:"Optional internal notes"})}),(0,n.jsxs)("div",{className:"md:col-span-2 flex flex-wrap gap-3",children:[n.jsx(x.z,{type:"submit",variant:"primary",children:T?"Save Changes":"Create Invoice"}),T?n.jsx(x.z,{type:"button",variant:"secondary",onClick:I,children:"Cancel"}):null]})]})})}),E?n.jsx(u.o,{tone:"error",message:E}):null,k?n.jsx(u.o,{tone:"info",message:"Loading invoices..."}):0===e.length?n.jsx(d.u,{description:"No invoices created yet."}):n.jsx(c.r,{title:"Invoice Directory",table:n.jsx(o.w,{columns:[{key:"invoice",header:"Invoice",cellClassName:"font-medium",render:e=>e.invoice_number},{key:"hotel",header:"Hotel",cellClassName:"text-[color:var(--color-text-muted)]",render:e=>e.tenant_name??e.tenant_id},{key:"plan",header:"Plan",cellClassName:"text-[color:var(--color-text-muted)]",render:e=>e.plan_name??e.plan_code??"-"},{key:"amount",header:"Amount",render:e=>`${(e.amount_cents/100).toFixed(2)} ${e.currency}`},{key:"status",header:"Status",render:e=>e.status},{key:"due",header:"Due",render:e=>e.due_at?new Date(e.due_at).toLocaleDateString():"-"},{key:"actions",header:"Actions",render:e=>(0,n.jsxs)(m.l,{children:[n.jsx(i.n,{permission:"admin:invoices:update",children:n.jsx(x.z,{size:"sm",variant:"outline",onClick:()=>z(e),children:"Edit"})}),n.jsx(i.n,{permission:"admin:invoices:delete",children:n.jsx(x.z,{size:"sm",variant:"danger",onClick:()=>void F(e),children:"Delete"})})]})}],rows:e,rowKey:e=>e.id})})]})})}},2802:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var n=s(326),a=s(4784),i=s(1072),r=s(9557);function l({children:e}){return n.jsx(r.E,{userType:"admin",children:n.jsx(a.q,{variant:"admin",children:(0,n.jsxs)("div",{className:"min-w-0",children:[n.jsx(i.w,{}),n.jsx("main",{className:"p-6",children:e})]})})})}},4863:(e,t,s)=>{"use strict";s.d(t,{m:()=>r});var n=s(326),a=s(1135),i=s(3118);function r({title:e,description:t,rightSlot:s,count:r,countLabel:l,className:o}){return(0,n.jsxs)("div",{className:(0,a.Z)("ui-page-header",o),children:[(0,n.jsxs)("div",{children:[n.jsx("h2",{className:"ui-page-title",children:e}),t?n.jsx("p",{className:"ui-page-subtitle",children:t}):null]}),(0,n.jsxs)("div",{className:"flex items-center gap-3",children:["number"==typeof r?(0,n.jsxs)(i.C,{variant:"accent",children:[r,l?` ${l}`:""]}):null,s]})]})}},6126:(e,t,s)=>{"use strict";s.d(t,{y:()=>i});var n=s(326),a=s(4612);function i({title:e,children:t}){return n.jsx(a.q,{title:e,children:t})}},3556:(e,t,s)=>{"use strict";s.d(t,{w:()=>i});var n=s(326),a=s(1135);function i({columns:e,rows:t,rowKey:s,emptyFallback:i=null,className:r}){return 0===t.length?n.jsx(n.Fragment,{children:i}):(0,n.jsxs)("table",{className:(0,a.Z)("ui-table",r),children:[n.jsx("thead",{children:n.jsx("tr",{children:e.map(e=>n.jsx("th",{className:(0,a.Z)("pb-3",e.headerClassName),children:e.header},e.key))})}),n.jsx("tbody",{children:t.map((t,i)=>n.jsx("tr",{children:e.map(e=>n.jsx("td",{className:(0,a.Z)("py-3",e.cellClassName),children:e.render(t,i)},e.key))},s(t,i)))})]})}},7574:(e,t,s)=>{"use strict";s.d(t,{r:()=>r});var n=s(326),a=s(6184),i=s(4612);function r({title:e,table:t,footer:s}){return(0,n.jsxs)(i.q,{title:e,children:[n.jsx(a.K,{children:t}),s?n.jsx("div",{className:"mt-3",children:s}):null]})}},1346:(e,t,s)=>{"use strict";s.d(t,{u:()=>i});var n=s(326),a=s(5430);function i({title:e="Nothing here yet",description:t}){return(0,n.jsxs)(a.W,{className:"p-6",children:[n.jsx("h3",{className:"text-lg",children:e}),n.jsx("p",{className:"mt-2 text-sm text-[color:var(--color-text-muted)]",children:t})]})}},6062:(e,t,s)=>{"use strict";s.d(t,{o:()=>i});var n=s(326),a=s(1135);function i({tone:e="info",message:t,className:s}){return n.jsx("p",{className:(0,a.Z)("ui-inline-alert",`ui-inline-alert-${e}`,s),children:t})}},6184:(e,t,s)=>{"use strict";s.d(t,{K:()=>i});var n=s(326),a=s(1135);function i({children:e,className:t}){return n.jsx("div",{className:(0,a.Z)("ui-table-wrap",t),children:e})}},4612:(e,t,s)=>{"use strict";s.d(t,{q:()=>r});var n=s(326),a=s(1135),i=s(5430);function r({title:e,actions:t,children:s,className:r}){return(0,n.jsxs)(i.W,{className:(0,a.Z)("p-6 ui-reveal",r),children:[(e||t)&&(0,n.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[e?n.jsx("h3",{className:"text-lg",children:e}):n.jsx("span",{}),t]}),n.jsx("div",{className:(0,a.Z)((e||t)&&"mt-4"),children:s})]})}},4381:(e,t,s)=>{"use strict";s.d(t,{l:()=>i});var n=s(326),a=s(1135);function i({children:e,className:t}){return n.jsx("div",{className:(0,a.Z)("flex flex-wrap gap-2",t),children:e})}},5430:(e,t,s)=>{"use strict";s.d(t,{W:()=>i});var n=s(326),a=s(1135);function i({children:e,className:t}){return n.jsx("div",{className:(0,a.Z)("glass-card",t),children:e})}},3118:(e,t,s)=>{"use strict";s.d(t,{C:()=>i});var n=s(326),a=s(1135);function i({variant:e="accent",className:t,children:s,...i}){return n.jsx("span",{className:(0,a.Z)("badge",`badge-${e}`,t),...i,children:s})}},7759:(e,t,s)=>{"use strict";s.d(t,{z:()=>i});var n=s(326),a=s(1135);function i({className:e,variant:t="secondary",size:s="md",children:i,...r}){return n.jsx("button",{className:(0,a.Z)("ui-btn ui-anim",`ui-btn-${t}`,"sm"===s&&"ui-btn-sm","md"===s&&"ui-btn-md","lg"===s&&"ui-btn-lg",e),...r,children:i})}},7118:(e,t,s)=>{"use strict";s.d(t,{g:()=>i});var n=s(326),a=s(1135);function i({label:e,required:t,hint:s,error:i,className:r,children:l}){return(0,n.jsxs)("div",{className:(0,a.Z)("space-y-2",r),children:[(0,n.jsxs)("label",{className:"text-sm",children:[e,t&&n.jsx("span",{className:"ml-1 text-[color:var(--color-accent)]",children:"*"})]}),l,i?n.jsx("p",{className:"text-xs text-red-400",children:i}):s?n.jsx("p",{className:"text-xs text-[color:var(--color-text-muted)]",children:s}):null]})}},5979:(e,t,s)=>{"use strict";s.d(t,{l:()=>i});var n=s(326),a=s(1135);function i({className:e,children:t,...s}){return n.jsx("select",{className:(0,a.Z)("ui-select",e),...s,children:t})}},5495:(e,t,s)=>{"use strict";s.d(t,{o:()=>i});var n=s(326),a=s(1135);function i({className:e,...t}){return n.jsx("input",{className:(0,a.Z)("ui-input",e),...t})}},4909:(e,t,s)=>{"use strict";s.d(t,{F:()=>i});var n=s(326),a=s(1135);function i({className:e,...t}){return n.jsx("textarea",{className:(0,a.Z)("ui-textarea",e),...t})}},1852:(e,t,s)=>{"use strict";s.d(t,{B:()=>a});var n=s(9684);let a={list:(e=1,t=20)=>(0,n.S)(`/admin/hotels?page=${e}&limit=${t}`),get:e=>(0,n.S)(`/admin/hotels/${e}`),create:e=>(0,n.S)("/admin/hotels",{method:"POST",body:JSON.stringify(e)}),update:(e,t)=>(0,n.S)(`/admin/hotels/${e}`,{method:"PUT",body:JSON.stringify(t)}),remove:e=>(0,n.S)(`/admin/hotels/${e}`,{method:"DELETE"})}},6649:(e,t,s)=>{"use strict";s.d(t,{J:()=>a});var n=s(9684);let a={list:(e=1,t=20)=>(0,n.S)(`/admin/subscriptions?page=${e}&limit=${t}`),get:e=>(0,n.S)(`/admin/subscriptions/${e}`),create:e=>(0,n.S)("/admin/subscriptions",{method:"POST",body:JSON.stringify(e)}),update:(e,t)=>(0,n.S)(`/admin/subscriptions/${e}`,{method:"PUT",body:JSON.stringify(t)}),remove:e=>(0,n.S)(`/admin/subscriptions/${e}`,{method:"DELETE"})}},2400:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>r,__esModule:()=>i,default:()=>l});var n=s(8570);let a=(0,n.createProxy)(String.raw`C:\Users\josep\Documents\AarkayTechnoConsultants\HMS\frontend\app\admin\invoices\page.tsx`),{__esModule:i,$$typeof:r}=a;a.default;let l=(0,n.createProxy)(String.raw`C:\Users\josep\Documents\AarkayTechnoConsultants\HMS\frontend\app\admin\invoices\page.tsx#default`)},596:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>r,__esModule:()=>i,default:()=>l});var n=s(8570);let a=(0,n.createProxy)(String.raw`C:\Users\josep\Documents\AarkayTechnoConsultants\HMS\frontend\app\admin\layout.tsx`),{__esModule:i,$$typeof:r}=a;a.default;let l=(0,n.createProxy)(String.raw`C:\Users\josep\Documents\AarkayTechnoConsultants\HMS\frontend\app\admin\layout.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),n=t.X(0,[5819,8591,9158],()=>s(5347));module.exports=n})();
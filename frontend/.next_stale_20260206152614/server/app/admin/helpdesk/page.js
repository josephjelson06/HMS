(()=>{var e={};e.id=5253,e.ids=[5253],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1826:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>o}),s(1119),s(596),s(4752),s(5866);var a=s(3191),r=s(8716),n=s(7922),i=s.n(n),l=s(5231),d={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);s.d(t,d);let o=["",{children:["admin",{children:["helpdesk",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,1119)),"C:\\Users\\josep\\Documents\\AarkayTechnoConsultants\\HMS\\frontend\\app\\admin\\helpdesk\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,596)),"C:\\Users\\josep\\Documents\\AarkayTechnoConsultants\\HMS\\frontend\\app\\admin\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,4752)),"C:\\Users\\josep\\Documents\\AarkayTechnoConsultants\\HMS\\frontend\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\josep\\Documents\\AarkayTechnoConsultants\\HMS\\frontend\\app\\admin\\helpdesk\\page.tsx"],u="/admin/helpdesk/page",m={require:s,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/admin/helpdesk/page",pathname:"/admin/helpdesk",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},5879:(e,t,s)=>{Promise.resolve().then(s.bind(s,743))},558:(e,t,s)=>{Promise.resolve().then(s.bind(s,2802))},743:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>S});var a=s(326),r=s(7577),n=s(9557),i=s(4863),l=s(6126),d=s(3556),o=s(7574),c=s(1346),u=s(6062),m=s(4381),p=s(5430),h=s(7759),x=s(7118),j=s(5979),g=s(4909),v=s(5495),y=s(9684);let f={list:e=>{let t=new URLSearchParams;e?.page&&t.set("page",e.page.toString()),e?.limit&&t.set("limit",e.limit.toString()),e?.status&&t.set("status",e.status),e?.priority&&t.set("priority",e.priority),e?.tenant_id&&t.set("tenant_id",e.tenant_id);let s=t.toString();return(0,y.S)(`/admin/helpdesk${s?`?${s}`:""}`)},create:e=>(0,y.S)("/admin/helpdesk",{method:"POST",body:JSON.stringify(e)}),update:(e,t)=>(0,y.S)(`/admin/helpdesk/${e}`,{method:"PUT",body:JSON.stringify(t)}),remove:e=>(0,y.S)(`/admin/helpdesk/${e}`,{method:"DELETE"})};var b=s(1852),k=s(2782);let N={tenant_id:"",requester_name:"",requester_email:"",subject:"",description:"",status:"open",priority:"normal",assigned_to:""};function S(){let[e,t]=(0,r.useState)([]),[s,y]=(0,r.useState)([]),[S,_]=(0,r.useState)([]),[C,q]=(0,r.useState)(!0),[P,w]=(0,r.useState)(N),[T,$]=(0,r.useState)(null),[E,D]=(0,r.useState)(null),A=(0,r.useCallback)(async()=>{q(!0),D(null);try{let[e,s,a]=await Promise.all([f.list({page:1,limit:50}),b.B.list(1,100),k.x.list(1,100)]);t(e.items),y(s.items),_(a.items)}catch(e){D(e instanceof Error?e.message:"Failed to load helpdesk tickets")}finally{q(!1)}},[]),Z=(e,t)=>{w(s=>({...s,[e]:t}))},M=()=>{w(N),$(null)},U=(0,r.useMemo)(()=>({tenant_id:P.tenant_id||void 0,requester_name:P.requester_name||void 0,requester_email:P.requester_email||void 0,subject:P.subject,description:P.description||void 0,status:P.status||void 0,priority:P.priority||void 0,assigned_to:P.assigned_to||void 0}),[P]),H=async e=>{e.preventDefault(),D(null);try{T?await f.update(T.id,U):await f.create(U),M(),await A()}catch(e){D(e instanceof Error?e.message:"Failed to save ticket")}},O=e=>{$(e),w({tenant_id:e.tenant_id??"",requester_name:e.requester_name??"",requester_email:e.requester_email??"",subject:e.subject,description:e.description??"",status:e.status,priority:e.priority,assigned_to:e.assigned_to??""})},z=async e=>{if(confirm(`Delete ticket "${e.subject}"? This cannot be undone.`))try{await f.remove(e.id),await A()}catch(e){D(e instanceof Error?e.message:"Failed to delete ticket")}};return a.jsx(n.n,{permission:"admin:helpdesk:read",fallback:(0,a.jsxs)(p.W,{className:"p-6",children:[a.jsx("h2",{className:"text-2xl",children:"Access denied"}),a.jsx("p",{className:"mt-2 text-sm text-[color:var(--color-text-muted)]",children:"You do not have permission to view HelpDesk tickets."})]}),children:(0,a.jsxs)("div",{className:"space-y-6",children:[a.jsx(i.m,{title:"HelpDesk",description:"Track support requests from hotels and internal teams.",count:e.length,countLabel:"Tickets"}),a.jsx(n.n,{permission:T?"admin:helpdesk:update":"admin:helpdesk:create",children:a.jsx(l.y,{title:T?"Edit Ticket":"Create Ticket",children:(0,a.jsxs)("form",{className:"grid gap-4 md:grid-cols-2",onSubmit:H,children:[a.jsx(x.g,{label:"Hotel",children:(0,a.jsxs)(j.l,{value:P.tenant_id,onChange:e=>Z("tenant_id",e.target.value),children:[a.jsx("option",{value:"",children:"Platform / Internal"}),s.map(e=>a.jsx("option",{value:e.id,children:e.name},e.id))]})}),a.jsx(x.g,{label:"Assigned To",children:(0,a.jsxs)(j.l,{value:P.assigned_to,onChange:e=>Z("assigned_to",e.target.value),children:[a.jsx("option",{value:"",children:"Unassigned"}),S.map(e=>a.jsx("option",{value:e.id,children:e.email},e.id))]})}),a.jsx(x.g,{label:"Requester Name",children:a.jsx(v.o,{value:P.requester_name,onChange:e=>Z("requester_name",e.target.value),placeholder:"Jane Doe"})}),a.jsx(x.g,{label:"Requester Email",children:a.jsx(v.o,{value:P.requester_email,onChange:e=>Z("requester_email",e.target.value),placeholder:"jane@example.com"})}),a.jsx(x.g,{label:"Subject",required:!0,className:"md:col-span-2",children:a.jsx(v.o,{value:P.subject,onChange:e=>Z("subject",e.target.value),placeholder:"Issue with booking sync",required:!0})}),a.jsx(x.g,{label:"Description",className:"md:col-span-2",children:a.jsx(g.F,{value:P.description,onChange:e=>Z("description",e.target.value),rows:3,placeholder:"Describe the issue or request"})}),a.jsx(x.g,{label:"Status",children:a.jsx(v.o,{value:P.status,onChange:e=>Z("status",e.target.value),placeholder:"open"})}),a.jsx(x.g,{label:"Priority",children:a.jsx(v.o,{value:P.priority,onChange:e=>Z("priority",e.target.value),placeholder:"normal"})}),(0,a.jsxs)("div",{className:"md:col-span-2 flex flex-wrap gap-3",children:[a.jsx(h.z,{type:"submit",variant:"primary",children:T?"Save Changes":"Create Ticket"}),T?a.jsx(h.z,{type:"button",variant:"secondary",onClick:M,children:"Cancel"}):null]})]})})}),E?a.jsx(u.o,{tone:"error",message:E}):null,C?a.jsx(u.o,{tone:"info",message:"Loading tickets..."}):0===e.length?a.jsx(c.u,{description:"No tickets created yet."}):a.jsx(o.r,{title:"Ticket Queue",table:a.jsx(d.w,{columns:[{key:"subject",header:"Subject",cellClassName:"font-medium",render:e=>e.subject},{key:"hotel",header:"Hotel",cellClassName:"text-[color:var(--color-text-muted)]",render:e=>e.tenant_name??"Platform"},{key:"status",header:"Status",render:e=>e.status},{key:"priority",header:"Priority",render:e=>e.priority},{key:"assignee",header:"Assignee",cellClassName:"text-[color:var(--color-text-muted)]",render:e=>e.assignee_email??"Unassigned"},{key:"actions",header:"Actions",render:e=>(0,a.jsxs)(m.l,{children:[a.jsx(n.n,{permission:"admin:helpdesk:update",children:a.jsx(h.z,{size:"sm",variant:"outline",onClick:()=>O(e),children:"Edit"})}),a.jsx(n.n,{permission:"admin:helpdesk:delete",children:a.jsx(h.z,{size:"sm",variant:"danger",onClick:()=>void z(e),children:"Delete"})})]})}],rows:e,rowKey:e=>e.id})})]})})}},2802:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var a=s(326),r=s(4784),n=s(1072),i=s(9557);function l({children:e}){return a.jsx(i.E,{userType:"admin",children:a.jsx(r.q,{variant:"admin",children:(0,a.jsxs)("div",{className:"min-w-0",children:[a.jsx(n.w,{}),a.jsx("main",{className:"p-6",children:e})]})})})}},4863:(e,t,s)=>{"use strict";s.d(t,{m:()=>i});var a=s(326),r=s(1135),n=s(3118);function i({title:e,description:t,rightSlot:s,count:i,countLabel:l,className:d}){return(0,a.jsxs)("div",{className:(0,r.Z)("ui-page-header",d),children:[(0,a.jsxs)("div",{children:[a.jsx("h2",{className:"ui-page-title",children:e}),t?a.jsx("p",{className:"ui-page-subtitle",children:t}):null]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:["number"==typeof i?(0,a.jsxs)(n.C,{variant:"accent",children:[i,l?` ${l}`:""]}):null,s]})]})}},6126:(e,t,s)=>{"use strict";s.d(t,{y:()=>n});var a=s(326),r=s(4612);function n({title:e,children:t}){return a.jsx(r.q,{title:e,children:t})}},3556:(e,t,s)=>{"use strict";s.d(t,{w:()=>n});var a=s(326),r=s(1135);function n({columns:e,rows:t,rowKey:s,emptyFallback:n=null,className:i}){return 0===t.length?a.jsx(a.Fragment,{children:n}):(0,a.jsxs)("table",{className:(0,r.Z)("ui-table",i),children:[a.jsx("thead",{children:a.jsx("tr",{children:e.map(e=>a.jsx("th",{className:(0,r.Z)("pb-3",e.headerClassName),children:e.header},e.key))})}),a.jsx("tbody",{children:t.map((t,n)=>a.jsx("tr",{children:e.map(e=>a.jsx("td",{className:(0,r.Z)("py-3",e.cellClassName),children:e.render(t,n)},e.key))},s(t,n)))})]})}},7574:(e,t,s)=>{"use strict";s.d(t,{r:()=>i});var a=s(326),r=s(6184),n=s(4612);function i({title:e,table:t,footer:s}){return(0,a.jsxs)(n.q,{title:e,children:[a.jsx(r.K,{children:t}),s?a.jsx("div",{className:"mt-3",children:s}):null]})}},1346:(e,t,s)=>{"use strict";s.d(t,{u:()=>n});var a=s(326),r=s(5430);function n({title:e="Nothing here yet",description:t}){return(0,a.jsxs)(r.W,{className:"p-6",children:[a.jsx("h3",{className:"text-lg",children:e}),a.jsx("p",{className:"mt-2 text-sm text-[color:var(--color-text-muted)]",children:t})]})}},6062:(e,t,s)=>{"use strict";s.d(t,{o:()=>n});var a=s(326),r=s(1135);function n({tone:e="info",message:t,className:s}){return a.jsx("p",{className:(0,r.Z)("ui-inline-alert",`ui-inline-alert-${e}`,s),children:t})}},6184:(e,t,s)=>{"use strict";s.d(t,{K:()=>n});var a=s(326),r=s(1135);function n({children:e,className:t}){return a.jsx("div",{className:(0,r.Z)("ui-table-wrap",t),children:e})}},4612:(e,t,s)=>{"use strict";s.d(t,{q:()=>i});var a=s(326),r=s(1135),n=s(5430);function i({title:e,actions:t,children:s,className:i}){return(0,a.jsxs)(n.W,{className:(0,r.Z)("p-6 ui-reveal",i),children:[(e||t)&&(0,a.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[e?a.jsx("h3",{className:"text-lg",children:e}):a.jsx("span",{}),t]}),a.jsx("div",{className:(0,r.Z)((e||t)&&"mt-4"),children:s})]})}},4381:(e,t,s)=>{"use strict";s.d(t,{l:()=>n});var a=s(326),r=s(1135);function n({children:e,className:t}){return a.jsx("div",{className:(0,r.Z)("flex flex-wrap gap-2",t),children:e})}},5430:(e,t,s)=>{"use strict";s.d(t,{W:()=>n});var a=s(326),r=s(1135);function n({children:e,className:t}){return a.jsx("div",{className:(0,r.Z)("glass-card",t),children:e})}},3118:(e,t,s)=>{"use strict";s.d(t,{C:()=>n});var a=s(326),r=s(1135);function n({variant:e="accent",className:t,children:s,...n}){return a.jsx("span",{className:(0,r.Z)("badge",`badge-${e}`,t),...n,children:s})}},7759:(e,t,s)=>{"use strict";s.d(t,{z:()=>n});var a=s(326),r=s(1135);function n({className:e,variant:t="secondary",size:s="md",children:n,...i}){return a.jsx("button",{className:(0,r.Z)("ui-btn ui-anim",`ui-btn-${t}`,"sm"===s&&"ui-btn-sm","md"===s&&"ui-btn-md","lg"===s&&"ui-btn-lg",e),...i,children:n})}},7118:(e,t,s)=>{"use strict";s.d(t,{g:()=>n});var a=s(326),r=s(1135);function n({label:e,required:t,hint:s,error:n,className:i,children:l}){return(0,a.jsxs)("div",{className:(0,r.Z)("space-y-2",i),children:[(0,a.jsxs)("label",{className:"text-sm",children:[e,t&&a.jsx("span",{className:"ml-1 text-[color:var(--color-accent)]",children:"*"})]}),l,n?a.jsx("p",{className:"text-xs text-red-400",children:n}):s?a.jsx("p",{className:"text-xs text-[color:var(--color-text-muted)]",children:s}):null]})}},5979:(e,t,s)=>{"use strict";s.d(t,{l:()=>n});var a=s(326),r=s(1135);function n({className:e,children:t,...s}){return a.jsx("select",{className:(0,r.Z)("ui-select",e),...s,children:t})}},5495:(e,t,s)=>{"use strict";s.d(t,{o:()=>n});var a=s(326),r=s(1135);function n({className:e,...t}){return a.jsx("input",{className:(0,r.Z)("ui-input",e),...t})}},4909:(e,t,s)=>{"use strict";s.d(t,{F:()=>n});var a=s(326),r=s(1135);function n({className:e,...t}){return a.jsx("textarea",{className:(0,r.Z)("ui-textarea",e),...t})}},1852:(e,t,s)=>{"use strict";s.d(t,{B:()=>r});var a=s(9684);let r={list:(e=1,t=20)=>(0,a.S)(`/admin/hotels?page=${e}&limit=${t}`),get:e=>(0,a.S)(`/admin/hotels/${e}`),create:e=>(0,a.S)("/admin/hotels",{method:"POST",body:JSON.stringify(e)}),update:(e,t)=>(0,a.S)(`/admin/hotels/${e}`,{method:"PUT",body:JSON.stringify(t)}),remove:e=>(0,a.S)(`/admin/hotels/${e}`,{method:"DELETE"})}},2782:(e,t,s)=>{"use strict";s.d(t,{x:()=>r});var a=s(9684);let r={list:(e=1,t=20)=>(0,a.S)(`/admin/users?page=${e}&limit=${t}`),get:e=>(0,a.S)(`/admin/users/${e}`),create:e=>(0,a.S)("/admin/users",{method:"POST",body:JSON.stringify(e)}),update:(e,t)=>(0,a.S)(`/admin/users/${e}`,{method:"PUT",body:JSON.stringify(t)}),remove:e=>(0,a.S)(`/admin/users/${e}`,{method:"DELETE"}),roles:()=>(0,a.S)("/admin/users/roles")}},1119:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>i,__esModule:()=>n,default:()=>l});var a=s(8570);let r=(0,a.createProxy)(String.raw`C:\Users\josep\Documents\AarkayTechnoConsultants\HMS\frontend\app\admin\helpdesk\page.tsx`),{__esModule:n,$$typeof:i}=r;r.default;let l=(0,a.createProxy)(String.raw`C:\Users\josep\Documents\AarkayTechnoConsultants\HMS\frontend\app\admin\helpdesk\page.tsx#default`)},596:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>i,__esModule:()=>n,default:()=>l});var a=s(8570);let r=(0,a.createProxy)(String.raw`C:\Users\josep\Documents\AarkayTechnoConsultants\HMS\frontend\app\admin\layout.tsx`),{__esModule:n,$$typeof:i}=r;r.default;let l=(0,a.createProxy)(String.raw`C:\Users\josep\Documents\AarkayTechnoConsultants\HMS\frontend\app\admin\layout.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[5819,8591,9158],()=>s(1826));module.exports=a})();
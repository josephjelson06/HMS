"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8407],{5854:function(e,t,n){n.d(t,{n:function(){return r},E:function(){return s}});var l=n(7437),a=n(3301);function r(e){let{permission:t,children:n,fallback:r=null}=e,{permissions:s,loading:i}=(0,a.a)();return i?null:!function(e,t){if(e.includes(t))return!0;let n=t.split(":");for(let t of e){if("*"===t)return!0;let e=t.split(":");if(e.length===n.length){let t=!0;for(let l=0;l<e.length;l+=1)if("*"!==e[l]&&e[l]!==n[l]){t=!1;break}if(t)return!0}if(e.length<n.length&&"*"===e[e.length-1]&&e.slice(0,e.length-1).join(":")===n.slice(0,e.length-1).join(":"))return!0}return!1}(s,t)?(0,l.jsx)(l.Fragment,{children:r}):(0,l.jsx)(l.Fragment,{children:n})}function s(e){let{userType:t,children:n,fallback:r=null}=e,{user:s,loading:i}=(0,a.a)();return i?null:s&&s.user_type===t?(0,l.jsx)(l.Fragment,{children:n}):(0,l.jsx)("div",{className:"auth-layout",children:(0,l.jsxs)("div",{className:"glass-card auth-card",children:[(0,l.jsx)("h2",{className:"text-2xl",children:"Access denied"}),(0,l.jsx)("p",{className:"mt-2 text-sm text-[color:var(--muted)]",children:"You do not have access to this workspace."}),r]})})}},6271:function(e,t,n){n.d(t,{w:function(){return o}});var l=n(7437),a=n(2265),r=n(6463),s=n(6058),i=n(3301);function o(){var e;let t=(0,r.useRouter)(),{toggleTheme:n,theme:o}=(0,s.F)(),{user:u,logout:d,impersonation:c,stopImpersonation:h}=(0,i.a)(),[m,f]=(0,a.useState)(!1),b=async()=>{f(!0);try{await h(),t.push("/admin/dashboard")}finally{f(!1)}};return(0,l.jsxs)(l.Fragment,{children:[(null==c?void 0:c.active)&&(0,l.jsxs)("div",{className:"mx-6 mt-6 flex flex-wrap items-center justify-between gap-3 rounded-xl border border-amber-300/30 bg-amber-500/10 px-4 py-3 text-sm",children:[(0,l.jsxs)("p",{children:["Impersonating hotel tenant ",(0,l.jsx)("span",{className:"font-semibold",children:c.tenant_name})]}),(0,l.jsx)("button",{className:"rounded-full border border-amber-200/40 px-4 py-1.5 text-xs font-semibold",onClick:()=>void b(),disabled:m,children:m?"Exiting...":"Exit impersonation"})]}),(0,l.jsxs)("header",{className:"navbar",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("h1",{className:"text-2xl",children:["Welcome, ",null!==(e=null==u?void 0:u.first_name)&&void 0!==e?e:"there"]}),(0,l.jsx)("p",{className:"text-sm text-[color:var(--muted)]",children:(null==c?void 0:c.active)?"Admin impersonation active.":"Foundation module ready."})]}),(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsxs)("button",{className:"rounded-full border border-white/10 px-4 py-2 text-sm",onClick:n,children:["dark"===o?"Light":"Dark"," mode"]}),(0,l.jsx)("button",{className:"rounded-full bg-white/10 px-4 py-2 text-sm",onClick:()=>void d(),children:"Logout"})]})]})]})}},8148:function(e,t,n){n.d(t,{q:function(){return f}});var l=n(7437),a=n(2265),r=n(7138),s=n(3301);let i=[{label:"Dashboard",href:"/admin/dashboard"},{label:"Hotel Registry",href:"/admin/hotels"},{label:"Kiosk Fleet",href:"/admin/kiosks"},{label:"Plans",href:"/admin/plans"},{label:"Subscriptions",href:"/admin/subscriptions"},{label:"Invoices",href:"/admin/invoices"},{label:"Reports",href:"/admin/reports"},{label:"Admin Users",href:"/admin/users"},{label:"Admin Roles",href:"/admin/roles"},{label:"Audit Logs",href:"/admin/audit"},{label:"HelpDesk",href:"/admin/helpdesk"},{label:"My Profile",href:"/admin/profile"},{label:"Settings",href:"/admin/settings"}],o=[{label:"Dashboard",href:"/hotel/dashboard"},{label:"Guest Registry",href:"/hotel/guests"},{label:"Room Management",href:"/hotel/rooms"},{label:"Incidents Record",href:"/hotel/incidents"},{label:"Users Management",href:"/hotel/users"},{label:"Roles Management",href:"/hotel/roles"},{label:"Kiosk Settings",href:"/hotel/kiosks"},{label:"Subscription & Billing",href:"/hotel/billing"},{label:"Help & Support",href:"/hotel/support"},{label:"Audit Logs",href:"/hotel/audit"},{label:"Reports",href:"/hotel/reports"},{label:"My Profile",href:"/hotel/profile"},{label:"Settings",href:"/hotel/settings"}];function u(e){var t;let{variant:n,onNavigate:a}=e,{user:u}=(0,s.a)();return(0,l.jsxs)("aside",{className:"sidebar glass-panel",children:[(0,l.jsxs)("div",{className:"mb-8",children:[(0,l.jsx)("p",{className:"text-xs uppercase text-[color:var(--muted)]",children:"HMS"}),(0,l.jsxs)("h2",{className:"text-xl font-semibold",children:["admin"===n?"Admin":"Hotel"," Panel"]}),(0,l.jsx)("p",{className:"text-xs text-[color:var(--muted)]",children:null!==(t=null==u?void 0:u.email)&&void 0!==t?t:""})]}),(0,l.jsx)("nav",{className:"space-y-2",children:("admin"===n?i:o).map(e=>(0,l.jsx)(r.default,{href:e.href,onClick:a,children:e.label},e.href))})]})}var d=n(4839);function c(e){let{open:t,onClose:n,children:a}=e;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("button",{"aria-label":"Close sidebar",className:(0,d.Z)("sidebar-drawer-overlay",t&&"sidebar-drawer-overlay-open"),onClick:n}),(0,l.jsx)("aside",{className:(0,d.Z)("sidebar-drawer ui-anim",t&&"sidebar-drawer-open"),children:a})]})}function h(e){let{className:t,label:n,children:a,...r}=e;return(0,l.jsx)("button",{"aria-label":n,title:n,className:(0,d.Z)("ui-icon-btn ui-btn ui-btn-outline ui-anim",t),...r,children:a})}function m(){return(0,l.jsx)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",width:"18",height:"18",children:(0,l.jsx)("path",{d:"M3 6h18M3 12h18M3 18h18"})})}function f(e){let{variant:t,children:n}=e,[r,s]=(0,a.useState)(!1);return(0,l.jsxs)("div",{className:"app-shell",children:[(0,l.jsx)("div",{className:"hidden lg:block",children:(0,l.jsx)(u,{variant:t})}),(0,l.jsxs)("div",{className:"min-w-0",children:[(0,l.jsxs)("div",{className:"app-mobile-topbar lg:hidden",children:[(0,l.jsx)(h,{label:"Open navigation",onClick:()=>s(!0),children:(0,l.jsx)(m,{})}),(0,l.jsxs)("p",{className:"text-sm font-medium capitalize",children:[t," workspace"]}),(0,l.jsx)("span",{})]}),n]}),(0,l.jsx)("div",{className:"lg:hidden",children:(0,l.jsx)(c,{open:r,onClose:()=>s(!1),children:(0,l.jsx)(u,{variant:t,onNavigate:()=>s(!1)})})})]})}},1288:function(e,t,n){n.d(t,{H:function(){return o},E:function(){return u}});var l=n(7437),a=n(2265),r=n(5139);let s={login:(e,t)=>(0,r.S)("/auth/login",{method:"POST",body:JSON.stringify({email:e,password:t})}),refresh:()=>(0,r.S)("/auth/refresh",{method:"POST"}),logout:()=>(0,r.S)("/auth/logout",{method:"POST"}),me:()=>(0,r.S)("/auth/me"),startImpersonation:e=>(0,r.S)("/auth/impersonation/start",{method:"POST",body:JSON.stringify(e)}),stopImpersonation:()=>(0,r.S)("/auth/impersonation/stop",{method:"POST"})},i=(0,a.createContext)(void 0);function o(e){let{children:t}=e,[n,r]=(0,a.useState)(null),[o,u]=(0,a.useState)([]),[d,c]=(0,a.useState)(null),[h,m]=(0,a.useState)(null),[f,b]=(0,a.useState)(!0),x=(0,a.useCallback)(e=>{var t,n;r(e.user),u(e.permissions),c(null!==(t=e.tenant)&&void 0!==t?t:null),m(null!==(n=e.impersonation)&&void 0!==n?n:null)},[]),p=(0,a.useCallback)(async()=>{try{let e=await s.me();x(e)}catch(e){try{let e=await s.refresh();x(e)}catch(e){r(null),u([]),c(null),m(null)}}finally{b(!1)}},[x]);(0,a.useEffect)(()=>{p()},[p]);let v=(0,a.useCallback)(async(e,t)=>{let n=await s.login(e,t);return x(n),n},[x]),g=(0,a.useCallback)(async()=>{await s.logout(),r(null),u([]),c(null),m(null)},[]),j=(0,a.useCallback)(async()=>{x(await s.refresh())},[x]),k=(0,a.useCallback)(async e=>{let t=await s.startImpersonation(e);return x(t),t},[x]),y=(0,a.useCallback)(async()=>{let e=await s.stopImpersonation();return x(e),e},[x]),N=(0,a.useMemo)(()=>({user:n,permissions:o,tenant:d,impersonation:h,loading:f,login:v,logout:g,refresh:j,startImpersonation:k,stopImpersonation:y}),[n,o,d,h,f,v,g,j,k,y]);return(0,l.jsx)(i.Provider,{value:N,children:t})}function u(){let e=(0,a.useContext)(i);if(!e)throw Error("useAuthContext must be used within AuthProvider");return e}},6058:function(e,t,n){n.d(t,{F:function(){return i},f:function(){return s}});var l=n(7437),a=n(2265);let r=(0,a.createContext)(void 0);function s(e){let{children:t}=e,[n,s]=(0,a.useState)("dark");(0,a.useEffect)(()=>{let e=localStorage.getItem("hms-theme");"light"===e||"dark"===e?(s(e),document.documentElement.setAttribute("data-theme",e)):document.documentElement.setAttribute("data-theme","dark")},[]);let i=(0,a.useCallback)(()=>{let e="dark"===n?"light":"dark";s(e),localStorage.setItem("hms-theme",e),document.documentElement.setAttribute("data-theme",e)},[n]),o=(0,a.useMemo)(()=>({theme:n,toggleTheme:i}),[n,i]);return(0,l.jsx)(r.Provider,{value:o,children:t})}function i(){let e=(0,a.useContext)(r);if(!e)throw Error("useTheme must be used within ThemeProvider");return e}},5139:function(e,t,n){var l;n.d(t,{S:function(){return r}});let a=null!==(l=n(357).env.NEXT_PUBLIC_API_URL)&&void 0!==l?l:"http://localhost:8000/api";async function r(e){var t,n,l;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s="".concat(a).concat(e),i=new Headers(null!==(n=r.headers)&&void 0!==n?n:{}),o=null!==(l=null===(t=r.method)||void 0===t?void 0:t.toUpperCase())&&void 0!==l?l:"GET";if("GET"!==o&&"HEAD"!==o){let e=function(){if("undefined"==typeof document)return null;let e=document.cookie.match(/csrf_token=([^;]+)/);return e?decodeURIComponent(e[1]):null}();e&&i.set("X-CSRF-Token",e),i.has("Content-Type")||i.set("Content-Type","application/json")}let u=await fetch(s,{...r,headers:i,credentials:"include"});if(!u.ok)throw Error(await u.text()||u.statusText);if(204===u.status)return;let d=await u.text();if(d)return JSON.parse(d)}},3301:function(e,t,n){n.d(t,{a:function(){return a}});var l=n(1288);function a(){return(0,l.E)()}},6463:function(e,t,n){var l=n(1169);n.o(l,"useParams")&&n.d(t,{useParams:function(){return l.useParams}}),n.o(l,"useRouter")&&n.d(t,{useRouter:function(){return l.useRouter}})}}]);
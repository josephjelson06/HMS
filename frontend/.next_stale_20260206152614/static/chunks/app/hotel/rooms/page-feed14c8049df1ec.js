(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8798],{388:function(e,t,a){Promise.resolve().then(a.bind(a,5737))},5737:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return _}});var r=a(7437),o=a(2265),n=a(5854),s=a(2145),l=a(4862),c=a(6572),i=a(6053),d=a(22),u=a(4024),m=a(6865),h=a(5205),p=a(4631),y=a(5427),v=a(7032),g=a(6243),x=a(7868),b=a(5139);let j={list:e=>{let t=new URLSearchParams;(null==e?void 0:e.page)&&t.set("page",e.page.toString()),(null==e?void 0:e.limit)&&t.set("limit",e.limit.toString()),(null==e?void 0:e.search)&&t.set("search",e.search);let a=t.toString();return(0,b.S)("/hotel/rooms".concat(a?"?".concat(a):""))},create:e=>(0,b.S)("/hotel/rooms",{method:"POST",body:JSON.stringify(e)}),update:(e,t)=>(0,b.S)("/hotel/rooms/".concat(e),{method:"PUT",body:JSON.stringify(t)}),remove:e=>(0,b.S)("/hotel/rooms/".concat(e),{method:"DELETE"})},f={number:"",room_type:"",floor:"",status:"available",capacity:"",rate_cents:"",currency:"USD",description:""};function _(){let[e,t]=(0,o.useState)([]),[a,b]=(0,o.useState)(!0),[_,S]=(0,o.useState)(f),[C,N]=(0,o.useState)(null),[k,w]=(0,o.useState)(null),[E,R]=(0,o.useState)(""),D=(0,o.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";b(!0),w(null);try{let a=await j.list({page:1,limit:50,search:e||void 0});t(a.items)}catch(e){w(e instanceof Error?e.message:"Failed to load rooms")}finally{b(!1)}},[]);(0,o.useEffect)(()=>{D()},[D]);let z=(e,t)=>{S(a=>({...a,[e]:t}))},T=()=>{S(f),N(null)},F=(0,o.useMemo)(()=>({number:_.number,room_type:_.room_type,floor:_.floor||void 0,status:_.status||void 0,capacity:_.capacity?Number(_.capacity):void 0,rate_cents:_.rate_cents?Number(_.rate_cents):void 0,currency:_.currency||void 0,description:_.description||void 0}),[_]),O=(0,o.useMemo)(()=>({number:_.number||void 0,room_type:_.room_type||void 0,floor:_.floor||void 0,status:_.status||void 0,capacity:_.capacity?Number(_.capacity):void 0,rate_cents:_.rate_cents?Number(_.rate_cents):void 0,currency:_.currency||void 0,description:_.description||void 0}),[_]),L=async e=>{e.preventDefault(),w(null);try{C?await j.update(C.id,O):await j.create(F),T(),await D(E)}catch(e){w(e instanceof Error?e.message:"Failed to save room")}},P=e=>{var t,a;N(e),S({number:e.number,room_type:e.room_type,floor:null!==(t=e.floor)&&void 0!==t?t:"",status:e.status,capacity:e.capacity?String(e.capacity):"",rate_cents:e.rate_cents?String(e.rate_cents):"",currency:e.currency,description:null!==(a=e.description)&&void 0!==a?a:""})},U=async e=>{if(confirm("Delete room ".concat(e.number,"? This cannot be undone.")))try{await j.remove(e.id),await D(E)}catch(e){w(e instanceof Error?e.message:"Failed to delete room")}};return(0,r.jsx)(n.n,{permission:"hotel:rooms:read",fallback:(0,r.jsxs)(p.W,{className:"p-6",children:[(0,r.jsx)("h2",{className:"text-2xl",children:"Access denied"}),(0,r.jsx)("p",{className:"mt-2 text-sm text-[color:var(--color-text-muted)]",children:"You do not have permission to view room management."})]}),children:(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)(s.m,{title:"Room Management",description:"Track room inventory, availability, and pricing.",count:e.length,countLabel:"Rooms"}),(0,r.jsx)(l.y,{title:"Search Rooms",children:(0,r.jsxs)(m.B,{children:[(0,r.jsx)(g.o,{value:E,onChange:e=>R(e.target.value),className:"md:w-80",placeholder:"Search by number or type"}),(0,r.jsx)(y.z,{variant:"secondary",onClick:()=>void D(E),children:"Search"})]})}),(0,r.jsx)(n.n,{permission:C?"hotel:rooms:update":"hotel:rooms:create",children:(0,r.jsx)(l.y,{title:C?"Edit Room":"Add Room",children:(0,r.jsxs)("form",{className:"grid gap-4 md:grid-cols-2",onSubmit:L,children:[(0,r.jsx)(v.g,{label:"Room Number",required:!0,children:(0,r.jsx)(g.o,{value:_.number,onChange:e=>z("number",e.target.value),placeholder:"101"})}),(0,r.jsx)(v.g,{label:"Room Type",required:!0,children:(0,r.jsx)(g.o,{value:_.room_type,onChange:e=>z("room_type",e.target.value),placeholder:"Deluxe"})}),(0,r.jsx)(v.g,{label:"Floor",children:(0,r.jsx)(g.o,{value:_.floor,onChange:e=>z("floor",e.target.value),placeholder:"1"})}),(0,r.jsx)(v.g,{label:"Status",children:(0,r.jsx)(g.o,{value:_.status,onChange:e=>z("status",e.target.value),placeholder:"available"})}),(0,r.jsx)(v.g,{label:"Capacity",children:(0,r.jsx)(g.o,{value:_.capacity,onChange:e=>z("capacity",e.target.value),placeholder:"2"})}),(0,r.jsx)(v.g,{label:"Rate (cents)",children:(0,r.jsx)(g.o,{value:_.rate_cents,onChange:e=>z("rate_cents",e.target.value),placeholder:"12900"})}),(0,r.jsx)(v.g,{label:"Currency",children:(0,r.jsx)(g.o,{value:_.currency,onChange:e=>z("currency",e.target.value),placeholder:"USD"})}),(0,r.jsx)(v.g,{label:"Description",className:"md:col-span-2",children:(0,r.jsx)(x.F,{value:_.description,onChange:e=>z("description",e.target.value),rows:3})}),(0,r.jsxs)("div",{className:"md:col-span-2 flex flex-wrap gap-3",children:[(0,r.jsx)(y.z,{type:"submit",variant:"primary",children:C?"Save Changes":"Create Room"}),C?(0,r.jsx)(y.z,{type:"button",variant:"secondary",onClick:T,children:"Cancel"}):null]})]})})}),k?(0,r.jsx)(u.o,{tone:"error",message:k}):null,a?(0,r.jsx)(u.o,{tone:"info",message:"Loading rooms..."}):0===e.length?(0,r.jsx)(d.u,{description:"No rooms added yet."}):(0,r.jsx)(i.r,{title:"Room Directory",table:(0,r.jsx)(c.w,{columns:[{key:"number",header:"Number",cellClassName:"font-medium",render:e=>e.number},{key:"type",header:"Type",cellClassName:"text-[color:var(--color-text-muted)]",render:e=>e.room_type},{key:"status",header:"Status",render:e=>e.status},{key:"capacity",header:"Capacity",render:e=>{var t;return null!==(t=e.capacity)&&void 0!==t?t:"-"}},{key:"rate",header:"Rate",render:e=>"".concat(e.rate_cents?(e.rate_cents/100).toFixed(2):"-"," ").concat(e.currency)},{key:"actions",header:"Actions",render:e=>(0,r.jsxs)(h.l,{children:[(0,r.jsx)(n.n,{permission:"hotel:rooms:update",children:(0,r.jsx)(y.z,{size:"sm",variant:"outline",onClick:()=>P(e),children:"Edit"})}),(0,r.jsx)(n.n,{permission:"hotel:rooms:delete",children:(0,r.jsx)(y.z,{size:"sm",variant:"danger",onClick:()=>void U(e),children:"Delete"})})]})}],rows:e,rowKey:e=>e.id})})]})})}}},function(e){e.O(0,[2602,2971,7023,1744],function(){return e(e.s=388)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4665],{991:function(t,e,n){Promise.resolve().then(n.bind(n,3076))},3076:function(t,e,n){"use strict";n.d(e,{default:function(){return i}});var r=n(7437),o=n(2265),u=n(6463),a=n(3301);function i(){let t=(0,u.useRouter)(),{login:e}=(0,a.a)(),[n,i]=(0,o.useState)(""),[s,l]=(0,o.useState)(""),[c,d]=(0,o.useState)(null),[f,h]=(0,o.useState)(!1),m=async r=>{r.preventDefault(),d(null),h(!0);try{let r=await e(n,s),o="admin"===r.user.user_type?"/admin/dashboard":"/hotel/dashboard";t.push(o)}catch(t){d(t instanceof Error?t.message:"Login failed")}finally{h(!1)}};return(0,r.jsxs)("form",{onSubmit:m,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm",children:"Email"}),(0,r.jsx)("input",{type:"email",required:!0,value:n,onChange:t=>i(t.target.value),className:"mt-2 w-full rounded-xl border border-white/10 bg-white/5 px-4 py-3 text-sm",placeholder:"you@company.com"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm",children:"Password"}),(0,r.jsx)("input",{type:"password",required:!0,value:s,onChange:t=>l(t.target.value),className:"mt-2 w-full rounded-xl border border-white/10 bg-white/5 px-4 py-3 text-sm",placeholder:"••••••••"})]}),c&&(0,r.jsx)("p",{className:"text-sm text-red-400",children:c}),(0,r.jsx)("button",{type:"submit",disabled:f,className:"w-full rounded-xl bg-[color:var(--accent)] py-3 text-sm font-semibold text-black shadow-glow disabled:opacity-70",children:f?"Signing in...":"Sign in"})]})}},1288:function(t,e,n){"use strict";n.d(e,{H:function(){return s},E:function(){return l}});var r=n(7437),o=n(2265),u=n(5139);let a={login:(t,e)=>(0,u.S)("/auth/login",{method:"POST",body:JSON.stringify({email:t,password:e})}),refresh:()=>(0,u.S)("/auth/refresh",{method:"POST"}),logout:()=>(0,u.S)("/auth/logout",{method:"POST"}),me:()=>(0,u.S)("/auth/me"),startImpersonation:t=>(0,u.S)("/auth/impersonation/start",{method:"POST",body:JSON.stringify(t)}),stopImpersonation:()=>(0,u.S)("/auth/impersonation/stop",{method:"POST"})},i=(0,o.createContext)(void 0);function s(t){let{children:e}=t,[n,u]=(0,o.useState)(null),[s,l]=(0,o.useState)([]),[c,d]=(0,o.useState)(null),[f,h]=(0,o.useState)(null),[m,p]=(0,o.useState)(!0),v=(0,o.useCallback)(t=>{var e,n;u(t.user),l(t.permissions),d(null!==(e=t.tenant)&&void 0!==e?e:null),h(null!==(n=t.impersonation)&&void 0!==n?n:null)},[]),y=(0,o.useCallback)(async()=>{try{let t=await a.me();v(t)}catch(t){try{let t=await a.refresh();v(t)}catch(t){u(null),l([]),d(null),h(null)}}finally{p(!1)}},[v]);(0,o.useEffect)(()=>{y()},[y]);let b=(0,o.useCallback)(async(t,e)=>{let n=await a.login(t,e);return v(n),n},[v]),x=(0,o.useCallback)(async()=>{await a.logout(),u(null),l([]),d(null),h(null)},[]),g=(0,o.useCallback)(async()=>{v(await a.refresh())},[v]),w=(0,o.useCallback)(async t=>{let e=await a.startImpersonation(t);return v(e),e},[v]),T=(0,o.useCallback)(async()=>{let t=await a.stopImpersonation();return v(t),t},[v]),S=(0,o.useMemo)(()=>({user:n,permissions:s,tenant:c,impersonation:f,loading:m,login:b,logout:x,refresh:g,startImpersonation:w,stopImpersonation:T}),[n,s,c,f,m,b,x,g,w,T]);return(0,r.jsx)(i.Provider,{value:S,children:e})}function l(){let t=(0,o.useContext)(i);if(!t)throw Error("useAuthContext must be used within AuthProvider");return t}},5139:function(t,e,n){"use strict";var r;n.d(e,{S:function(){return u}});let o=null!==(r=n(357).env.NEXT_PUBLIC_API_URL)&&void 0!==r?r:"http://localhost:8000/api";async function u(t){var e,n,r;let u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a="".concat(o).concat(t),i=new Headers(null!==(n=u.headers)&&void 0!==n?n:{}),s=null!==(r=null===(e=u.method)||void 0===e?void 0:e.toUpperCase())&&void 0!==r?r:"GET";if("GET"!==s&&"HEAD"!==s){let t=function(){if("undefined"==typeof document)return null;let t=document.cookie.match(/csrf_token=([^;]+)/);return t?decodeURIComponent(t[1]):null}();t&&i.set("X-CSRF-Token",t),i.has("Content-Type")||i.set("Content-Type","application/json")}let l=await fetch(a,{...u,headers:i,credentials:"include"});if(!l.ok)throw Error(await l.text()||l.statusText);if(204===l.status)return;let c=await l.text();if(c)return JSON.parse(c)}},3301:function(t,e,n){"use strict";n.d(e,{a:function(){return o}});var r=n(1288);function o(){return(0,r.E)()}},6463:function(t,e,n){"use strict";var r=n(1169);n.o(r,"useParams")&&n.d(e,{useParams:function(){return r.useParams}}),n.o(r,"useRouter")&&n.d(e,{useRouter:function(){return r.useRouter}})},357:function(t,e,n){"use strict";var r,o;t.exports=(null==(r=n.g.process)?void 0:r.env)&&"object"==typeof(null==(o=n.g.process)?void 0:o.env)?n.g.process:n(8081)},8081:function(t){!function(){var e={229:function(t){var e,n,r,o=t.exports={};function u(){throw Error("setTimeout has not been defined")}function a(){throw Error("clearTimeout has not been defined")}function i(t){if(e===setTimeout)return setTimeout(t,0);if((e===u||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(n){try{return e.call(null,t,0)}catch(n){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:u}catch(t){e=u}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(t){n=a}}();var s=[],l=!1,c=-1;function d(){l&&r&&(l=!1,r.length?s=r.concat(s):c=-1,s.length&&f())}function f(){if(!l){var t=i(d);l=!0;for(var e=s.length;e;){for(r=s,s=[];++c<e;)r&&r[c].run();c=-1,e=s.length}r=null,l=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function h(t,e){this.fun=t,this.array=e}function m(){}o.nextTick=function(t){var e=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];s.push(new h(t,e)),1!==s.length||l||i(f)},h.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(t){return[]},o.binding=function(t){throw Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw Error("process.chdir is not supported")},o.umask=function(){return 0}}},n={};function r(t){var o=n[t];if(void 0!==o)return o.exports;var u=n[t]={exports:{}},a=!0;try{e[t](u,u.exports,r),a=!1}finally{a&&delete n[t]}return u.exports}r.ab="//";var o=r(229);t.exports=o}()}},function(t){t.O(0,[2971,7023,1744],function(){return t(t.s=991)}),_N_E=t.O()}]);